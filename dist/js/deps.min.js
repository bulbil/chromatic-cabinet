var ascii=function(){function t(t,n){for(var a=" .,:;i1tfLCG08@".split(""),o=t.getContext("2d"),i=t.width,c=t.height,d="",s=259*(n.contrast+255)/(255*(259-n.contrast)),u=o.getImageData(0,0,i,c),h=0;h<c;h+=2){for(var g=0;g<i;g++){var l=4*(h*i+g),f=e(u.data,l),w={red:r(Math.floor((f.red-128)*s)+128,[0,255]),green:r(Math.floor((f.green-128)*s)+128,[0,255]),blue:r(Math.floor((f.blue-128)*s)+128,[0,255]),alpha:f.alpha},m=(.299*w.red+.587*w.green+.114*w.blue)/255,v=a[a.length-1-Math.round(m*(a.length-1))];d+=v}d+="\n"}n.callback(d)}function e(t,e){return{red:t[e],green:t[e+1],blue:t[e+2],alpha:t[e+3]}}function r(t,e){return Math.max(e[0],Math.min(e[1],t))}return{fromCanvas:function(e,r){return r=r||{},r.contrast="undefined"==typeof r.contrast?128:r.contrast,r.callback=r.callback||doNothing,t(e,r)}}}(),camera=function(){function t(){i=document.createElement("video"),i.setAttribute("width",o.width),i.setAttribute("height",o.height),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,navigator.getUserMedia?navigator.getUserMedia({video:!0},function(t){o.onSuccess(),void 0!==i.mozSrcObject?i.mozSrcObject=t:i.src=window.URL&&window.URL.createObjectURL(t)||t,e()},o.onError):o.onNotSupported()}function e(){c=o.targetCanvas||document.createElement("canvas"),c.setAttribute("width",o.width),c.setAttribute("height",o.height),d=c.getContext("2d"),o.mirror&&(d.translate(c.width,0),d.scale(-1,1)),r()}function r(){i.play(),s=setInterval(function(){try{d.drawImage(i,0,0,i.width,i.height),o.onFrame(c)}catch(t){}},Math.round(1e3/o.fps))}function n(){a(),void 0!==i.mozSrcObject?i.mozSrcObject=null:i.src=""}function a(){s&&clearInterval(s),i.pause()}var o,i,c,d,s;return{init:function(e){var r=function(){};o=e||{},o.fps=o.fps||30,o.width=o.width||640,o.height=o.height||480,o.mirror=o.mirror||!1,o.targetCanvas=o.targetCanvas||null,o.onSuccess=o.onSuccess||r,o.onError=o.onError||r,o.onNotSupported=o.onNotSupported||r,o.onFrame=o.onFrame||r,t()},start:r,pause:a,stop:n}}();